<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>טופס עיצוב משחק אישי - TailorPlayed</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Premium Pixar-Apple Palette */
            --ikea-yellow: #FFD93D;
            --ikea-yellow-glow: #FFE566;
            --dark-purple: #2D1B3D;
            --deep-purple: #1E1229;
            --royal-purple: #5C3A7A;
            --soft-purple: #7B5C96;
            --lavender-mist: #C4B0D6;
            --gold-accent: #FFC627;
            
            /* Premium refined colors */
            --card-glass: rgba(255, 255, 255, 0.08);
            --text-light: #FFFFFF;
            --text-muted: #E3D5F0;
            --bg-card: rgba(52, 36, 80, 0.6);
            --bg-overlay: rgba(30, 18, 41, 0.92);
            --shadow-glow: rgba(255, 217, 61, 0.25);
            --shadow-purple: rgba(92, 58, 122, 0.4);
            --border-subtle: rgba(255, 217, 61, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Fredoka', sans-serif;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background: linear-gradient(165deg, #1E1229 0%, #2D1B3D 40%, #3A2550 80%, #2D1B3D 100%);
            color: var(--text-light);
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Softer magical background effects */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 15% 25%, rgba(92, 58, 122, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 85% 75%, rgba(255, 217, 61, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(123, 92, 150, 0.12) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        /* Floating particles effect */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--ikea-yellow);
            border-radius: 50%;
            opacity: 0.6;
            animation: float 15s infinite ease-in-out;
            box-shadow: 0 0 10px var(--ikea-yellow);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 0.6; }
            50% { transform: translateY(-100vh) translateX(50px); opacity: 0.4; }
            90% { opacity: 0.6; }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--bg-overlay);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-radius: 24px;
            padding: 50px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 0 0 1px var(--border-subtle),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
            position: relative;
            z-index: 2;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .container::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(145deg, 
                rgba(255, 217, 61, 0.12) 0%, 
                rgba(92, 58, 122, 0.12) 50%, 
                rgba(255, 217, 61, 0.08) 100%);
            border-radius: 24px;
            z-index: -1;
            opacity: 0.6;
            filter: blur(20px);
        }

        h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.8rem;
            font-weight: 700;
            text-align: center;
            background: linear-gradient(135deg, var(--ikea-yellow) 0%, var(--gold-accent) 50%, var(--ikea-yellow) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            text-align: center;
            color: var(--text-muted);
            font-size: 1.2rem;
            margin-bottom: 40px;
            font-weight: 500;
            font-family: 'Fredoka', sans-serif;
            letter-spacing: 0.3px;
        }

        /* Premium Instructions Box */
        .instructions-box {
            background: linear-gradient(145deg, var(--card-glass), rgba(92, 58, 122, 0.1));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 50px;
            border: 1px solid var(--border-subtle);
            box-shadow: 
                0 4px 24px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .instructions-title {
            color: var(--ikea-yellow);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            letter-spacing: -0.3px;
            border: none;
            padding: 0;
            background: none;
        }

        .instructions-text {
            text-align: center;
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .instructions-steps {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .instruction-step {
            display: flex;
            gap: 20px;
            background: rgba(255, 255, 255, 0.03);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255, 217, 61, 0.1);
            transition: all 0.3s ease;
        }

        .instruction-step:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 217, 61, 0.2);
            transform: translateX(-3px);
        }

        .highlight-step {
            background: linear-gradient(135deg, rgba(255, 217, 61, 0.08), rgba(92, 58, 122, 0.08));
            border-color: rgba(255, 217, 61, 0.25);
        }

        .step-number {
            flex-shrink: 0;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--ikea-yellow), var(--gold-accent));
            color: var(--dark-purple);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            font-weight: 700;
            box-shadow: 0 4px 12px var(--shadow-glow);
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            display: block;
            color: var(--ikea-yellow);
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .step-content p {
            color: var(--text-muted);
            line-height: 1.6;
            margin: 0;
            font-size: 0.95rem;
        }

        .email-link {
            color: var(--ikea-yellow);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
        }

        .email-link:hover {
            border-bottom-color: var(--ikea-yellow);
            text-shadow: 0 0 12px var(--shadow-glow);
        }

        h2 {
            font-size: 1.7rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            background: linear-gradient(135deg, rgba(92, 58, 122, 0.4) 0%, rgba(92, 58, 122, 0.2) 100%);
            color: var(--ikea-yellow);
            padding: 18px 28px;
            border-radius: 16px;
            margin: 50px 0 30px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-subtle);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            cursor: pointer;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            filter: grayscale(1);
        }

        h2 .emoji {
            filter: grayscale(0);
        }

        h2::after {
            content: '▼';
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            margin-left: 15px;
        }

        h2.collapsed::after {
            transform: rotate(-90deg);
        }

        h2::before {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 217, 61, 0.1), transparent);
            transition: right 0.8s ease;
        }

        h2:hover::before {
            right: 100%;
        }

        .section-content {
            max-height: 5000px;
            overflow: hidden;
            transition: max-height 0.5s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .section-content.collapsed {
            max-height: 0;
            opacity: 0;
        }

        h3 {
            color: var(--ikea-yellow);
            font-size: 1.4rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            margin: 30px 0 20px;
            padding-right: 20px;
            border-right: 5px solid var(--ikea-yellow);
            text-shadow: 0 0 15px var(--shadow-glow);
        }

        .question {
            background: var(--bg-card);
            backdrop-filter: blur(15px);
            border-radius: 14px;
            padding: 24px;
            margin-bottom: 22px;
            border: 1px solid var(--border-subtle);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            position: relative;
        }

        .question::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--ikea-yellow), var(--gold-accent));
            border-radius: 0 14px 14px 0;
            opacity: 0.6;
        }

        .question:hover {
            transform: translateX(-3px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            border-color: rgba(255, 217, 61, 0.25);
            background: rgba(52, 36, 80, 0.7);
        }

        .question-title {
            font-weight: 700;
            color: var(--ikea-yellow);
            font-size: 1.1rem;
            margin-bottom: 15px;
            text-shadow: 0 0 10px var(--shadow-glow);
            font-family: 'Fredoka', sans-serif;
        }

        .description {
            font-size: 0.95rem;
            color: var(--lavender-mist);
            font-style: italic;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 218, 26, 0.05);
            border-radius: 8px;
            border-right: 3px solid var(--ikea-yellow);
            font-family: 'Fredoka', sans-serif;
        }

        .options {
            margin: 15px 0;
            font-family: 'Fredoka', sans-serif;
        }

        .option {
            display: block;
            padding: 10px 15px;
            margin: 8px 0;
            background: rgba(74, 44, 107, 0.3);
            border-radius: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
            font-family: 'Fredoka', sans-serif;
        }

        .option:hover {
            background: rgba(255, 218, 26, 0.1);
            border-color: var(--ikea-yellow);
            transform: translateX(-3px);
        }

        .option input[type="checkbox"],
        .option input[type="radio"] {
            margin-left: 12px;
            cursor: pointer;
            width: 20px;
            height: 20px;
            appearance: none;
            -webkit-appearance: none;
            background: var(--dark-purple);
            border: 2px solid var(--ikea-yellow);
            border-radius: 4px;
            position: relative;
            transition: all 0.2s ease;
        }

        .option input[type="radio"] {
            border-radius: 50%;
        }

        .option input[type="checkbox"]:checked,
        .option input[type="radio"]:checked {
            background: var(--ikea-yellow);
            border-color: var(--ikea-yellow);
        }

        .option input[type="checkbox"]:checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--dark-purple);
            font-size: 14px;
            font-weight: bold;
        }

        .option input[type="radio"]:checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: var(--dark-purple);
            border-radius: 50%;
        }

        .option input[type="checkbox"]:hover,
        .option input[type="radio"]:hover {
            border-color: var(--ikea-yellow-glow);
            box-shadow: 0 0 8px var(--shadow-glow);
        }

        .text-input {
            width: 100%;
            padding: 15px;
            background: rgba(26, 15, 41, 0.6);
            border: 2px solid var(--royal-purple);
            border-radius: 12px;
            color: var(--text-light);
            font-size: 1rem;
            font-family: 'Fredoka', sans-serif;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--ikea-yellow);
            background: rgba(26, 15, 41, 0.8);
            box-shadow: 0 0 20px var(--shadow-glow), inset 0 0 10px rgba(255, 218, 26, 0.1);
        }

        .text-input::placeholder {
            color: var(--lavender-mist);
        }

        .textarea {
            min-height: 100px;
            resize: vertical;
        }

        .large-textarea {
            min-height: 150px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
        }

        .json-btn {
            background: linear-gradient(135deg, var(--royal-purple) 0%, var(--soft-purple) 100%);
            color: var(--ikea-yellow);
            border: 2px solid var(--ikea-yellow);
        }

        .json-btn-large {
            background: linear-gradient(135deg, var(--ikea-yellow) 0%, var(--gold-accent) 100%);
            color: var(--dark-purple);
            border: none;
            padding: 20px 50px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.4rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px var(--shadow-glow);
            position: relative;
            overflow: hidden;
        }

        .json-btn-large::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .json-btn-large:hover::before {
            width: 400px;
            height: 400px;
        }

        .json-btn-large:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 50px var(--shadow-glow);
        }

        .next-section-btn {
            background: linear-gradient(135deg, var(--ikea-yellow), var(--gold-accent));
            color: var(--dark-purple);
            border: none;
            padding: 12px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            margin: 30px auto 0;
            display: block;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-glow);
        }

        .next-section-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px var(--shadow-glow);
        }

        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--ikea-yellow) 20%, 
                var(--royal-purple) 50%, 
                var(--ikea-yellow) 80%, 
                transparent 100%);
            margin: 50px 0;
            border-radius: 3px;
            box-shadow: 0 0 20px var(--shadow-glow);
        }

        .list-item {
            margin-bottom: 20px;
            padding: 20px;
            padding-top: 45px;
            background: rgba(26, 15, 41, 0.5);
            border: 2px solid var(--royal-purple);
            border-radius: 15px;
            position: relative;
            transition: all 0.3s ease;
        }

        .list-item:hover {
            border-color: var(--ikea-yellow);
            box-shadow: 0 5px 25px var(--shadow-purple);
        }

        .add-item-btn {
            background: linear-gradient(135deg, var(--royal-purple), var(--soft-purple));
            color: var(--ikea-yellow);
            border: 2px solid var(--ikea-yellow);
            padding: 12px 25px;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 1rem;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-purple);
        }

        .add-item-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px var(--shadow-purple), 0 0 20px var(--shadow-glow);
        }

        .remove-item-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.5);
            transition: all 0.3s ease;
        }

        .remove-item-btn:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.8);
        }

        .color-picker {
            width: 60px;
            height: 40px;
            border: 3px solid var(--ikea-yellow);
            border-radius: 10px;
            cursor: pointer;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .color-picker:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px var(--shadow-glow);
        }

        .conditional-field {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 218, 26, 0.05);
            border-radius: 10px;
            border: 2px dashed var(--ikea-yellow);
        }

        .file-upload-label {
            display: inline-block;
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--royal-purple), var(--soft-purple));
            color: var(--ikea-yellow);
            border: 2px solid var(--ikea-yellow);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            margin-top: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-purple);
        }

        .file-upload-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px var(--shadow-purple), 0 0 20px var(--shadow-glow);
        }

        #inspiration-file {
            display: none;
        }

        #file-name-display {
            margin-right: 20px;
            color: var(--lavender-mist);
            font-style: italic;
            font-family: 'Fredoka', sans-serif;
        }

        .json-output-container {
            margin-top: 50px;
            display: none;
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--ikea-yellow);
            box-shadow: 0 10px 40px var(--shadow-purple);
            font-family: 'Fredoka', sans-serif;
        }

        .json-output {
            background: var(--deep-purple);
            color: var(--ikea-yellow-glow);
            padding: 25px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 500px;
            overflow-y: auto;
            direction: ltr;
            border: 2px solid var(--royal-purple);
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5);
        }

        .copy-btn {
            background: linear-gradient(135deg, var(--ikea-yellow), var(--gold-accent));
            color: var(--dark-purple);
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 1rem;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-glow);
        }

        .copy-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px var(--shadow-glow);
        }

        .copy-feedback {
            color: var(--ikea-yellow);
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Fredoka', sans-serif;
            margin-right: 20px;
            display: inline-block;
            opacity: 0;
            transition: opacity 0.5s;
            text-shadow: 0 0 15px var(--shadow-glow);
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: var(--deep-purple);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--ikea-yellow), var(--royal-purple));
            border-radius: 10px;
            border: 2px solid var(--deep-purple);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--gold-accent), var(--soft-purple));
        }

        @media print {
            body { background: white; }
            .no-print { display: none; }
            .container { box-shadow: none; border: 2px solid #333; background: white; }
            h1, h2, h3, .question-title { color: #333; }
            .question { background: #f5f5f5; border-color: #ccc; }
        }

        @media (max-width: 768px) {
            .container { padding: 30px 20px; }
            h1 { font-size: 2rem; }
            .subtitle { font-size: 1rem; }
            .btn { padding: 12px 20px; font-size: 0.9rem; }
            .json-btn-large { padding: 15px 35px; font-size: 1.2rem; }
            
            .instructions-box { padding: 25px; }
            .instructions-title { font-size: 1.3rem; }
            .instructions-text { font-size: 1rem; }
            
            .instruction-step {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
            }
            
            .step-number {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .step-content strong { font-size: 1rem; }
            .step-content p { font-size: 0.9rem; }
            
            h2 { font-size: 1.4rem; padding: 15px 20px; }
            h3 { font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <!-- Floating particles -->
    <div class="particles">
        <div class="particle" style="right: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="right: 25%; animation-delay: 2s;"></div>
        <div class="particle" style="right: 40%; animation-delay: 4s;"></div>
        <div class="particle" style="right: 55%; animation-delay: 1s;"></div>
        <div class="particle" style="right: 70%; animation-delay: 3s;"></div>
        <div class="particle" style="right: 85%; animation-delay: 5s;"></div>
        <div class="particle" style="right: 15%; animation-delay: 6s;"></div>
        <div class="particle" style="right: 50%; animation-delay: 7s;"></div>
    </div>



    <div class="container">
        <h1>🪡 Tailor Played 🎲</h1>
        <p class="subtitle">טופס הזמנת משחק</p>
        
        <style>
        h1 {
            filter: grayscale(100%);
        }
        </style>
        
        <!-- Instructions Section -->
        <div class="instructions-box">
            <h3 class="instructions-title">ברוכים הבאים לשלב הראשון בבניית המשחק!</h3>
            <p class="instructions-text">בקרוב נתחיל לתפור משחק שאתם מכירים רק שעדיין לא פגשתם 🎯</p>
            
            <div class="instructions-steps">
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>ענו על כל השאלות בסבלנות</strong>
                        <p>זה נכון שזה לוקח זמן, אבל ככל שתתנו לנו יותר פרטים - כך נוכל לדייק את המשחק בדיוק עבורכם. גם משחק עם פחות פרטים יהיה כיף, אבל אנחנו רוצים שהוא ירגיש מאוד מאוד שלכם.</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>הפכו את התשובות לפורמט JSON</strong>
                        <p>בסוף הטופס תמצאו כפתור שהופך את כל התשובות שלכם לפורמט טכני שהמערכת שלנו יכולה לקרוא. פשוט לחצו על הכפתור והעתיקו את הטקסט שנוצר.</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>תמונות? בהחלט!</strong>
                        <p>יש לכם תמונות של מקומות, חפצים, דמויות, חיות מחמד או כל דבר אחר שחשוב לכם? צרפו אותם למייל יחד עם התשובות - הן יכולות להוסיף קסם מיוחד למשחק.</p>
                    </div>
                </div>
                
                <div class="instruction-step highlight-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <strong>שלחו אלינו!</strong>
                        <p>את התשובות בפורמט JSON (והתמונות אם יש) שלחו למייל:<br>
                        <a href="mailto:benovate10@gmail.com" class="email-link">benovate10@gmail.com</a></p>
                    </div>
                </div>
            </div>
        </div>
        
        <form id="gameForm">
            <!-- Section 1: Basic Details -->
            <h2>🎯 שלב 1: פרטים בסיסיים על המשחק</h2>
            <div class="section-content">
            <h3>מידע כללי על המשחק</h3>
            
            <div class="question">
                <div class="question-title">למי מיועד המשחק?</div>
                <div class="options">
                    <label class="option"><input type="radio" name="target" value="me"> לי</label>
                    <label class="option"><input type="radio" name="target" value="partner"> לבן/בת זוג</label>
                    <label class="option"><input type="radio" name="target" value="family"> למשפחה</label>
                    <label class="option"><input type="radio" name="target" value="friends"> לחברים</label>
                    <label class="option"><input type="radio" name="target" value="old_friend"> חבר/ה מהעבר</label>
                    <label class="option"><input type="radio" name="target" value="other"> אחר</label>
                </div>
                <div class="question-title">פרטו לנו בקצרה (למה בחרתם באפשרות זו / מי הנמען הספציפי):</div>
                <textarea class="text-input textarea" name="target_description" placeholder="2-3 משפטים..."></textarea>
            </div>
            
            <div class="question">
                <div class="question-title">עבור כמה שחקנים מיועד המשחק?</div>
                <div class="options">
                    <label class="option"><input type="radio" name="players" value="1"> 1 (משחק סולו)</label>
                    <label class="option"><input type="radio" name="players" value="2"> 2</label>
                    <label class="option"><input type="radio" name="players" value="2-4"> 2-4</label>
                    <label class="option"><input type="radio" name="players" value="3-6"> 3-6</label>
                    <label class="option"><input type="radio" name="players" value="5+"> 5+</label>
                    <label class="option"><input type="radio" name="players" value="other"> אחר: <input type="text" name="players_other" class="text-input" style="width: 120px; display: inline-block; margin-right: 10px;"></label>
                </div>
            </div>
            
            <div class="question">
                <div class="question-title">כמה זמן תרצו שהמשחק ייקח?</div>
                <div class="options">
                    <label class="option"><input type="radio" name="duration" value="short"> עד 30 דקות</label>
                    <label class="option"><input type="radio" name="duration" value="medium"> בינוני: 30-60 דקות</label>
                    <label class="option"><input type="radio" name="duration" value="medium-long"> בינוני-ארוך: 60-90 דקות</label>
                    <label class="option"><input type="radio" name="duration" value="long"> ארוך: 90-120 דקות</label>
                </div>
            </div>
            
            <div class="question">
                <div class="question-title">מה האירוע או המטרה שלשמה נוצר המשחק?</div>
                <div class="description">לדוגמה: יום הולדת, יום נישואין, מפגש משפחתי, סתם בשביל הכיף, מתנת פרידה וכו'</div>
                <input type="text" name="event_purpose" class="text-input" placeholder="תיאור קצר של האירוע או המטרה...">
            </div>
            
            <button type="button" class="next-section-btn" onclick="goToNextSection(1)">מעבר לשלב הבא ⬅️</button>
            </div>
            
            <div class="section-divider"></div>
            
            <!-- Section 2: Game Nature & Mechanics -->
            <h2>⚙️ שלב 2: אופי המשחק ומכניקה</h2>
            <div class="section-content">
            <h3>ז'אנר ומורכבות</h3>
            
            <div class="question">
                <div class="question-title">מה רמת המורכבות המבוקשת של המשחק?</div>
                <div class="options">
                    <label class="option"><input type="radio" name="complexity" value="light"> קליל: חוקים פשוטים, החלטות לא רבות</label>
                    <label class="option"><input type="radio" name="complexity" value="medium"> בינוני: דורש חשיבה, אך לא מכביד מדי</label>
                    <label class="option"><input type="radio" name="complexity" value="challenging"> מאתגר: דורש תכנון ואסטרטגיה מעמיקה</label>
                </div>
            </div>
            
            <div class="question">
                <div class="question-title">איזה סוג/ז'אנר משחק מועדף עליכם? (ניתן לבחור מספר אפשרויות)</div>
                <div class="options">
                    <label class="option"><input type="checkbox" name="genre" value="strategy"> אסטרטגיה</label>
                    <label class="option"><input type="checkbox" name="genre" value="tactics"> טקטיקה</label>
                    <label class="option"><input type="checkbox" name="genre" value="party"> מסיבות / חברתי</label>
                    <label class="option"><input type="checkbox" name="genre" value="adventure"> הרפתקאות / חקר</label>
                    <label class="option"><input type="checkbox" name="genre" value="economic"> כלכלי / מסחר</label>
                    <label class="option"><input type="checkbox" name="genre" value="negotiation"> משא ומתן / דיפלומטיה</label>
                    <label class="option"><input type="checkbox" name="genre" value="collection"> איסוף סטים / בניית מנוע</label>
                    <label class="option"><input type="checkbox" name="genre" value="deduction"> דדוקציה / חקירה</label>
                    <label class="option"><input type="checkbox" name="genre" value="racing"> מרוצים</label>
                    <label class="option"><input type="checkbox" name="genre" value="cooperative"> שיתוף פעולה</label>
                    <label class="option"><input type="checkbox" name="genre" value="territory"> שליטה בשטחים</label>
                    <label class="option"><input type="checkbox" name="genre" value="roleplay"> משחק תפקידים</label>
                    <label class="option"><input type="checkbox" name="genre" value="dexterity"> מיומנות / זריזות ידיים</label>
                    <label class="option"><input type="checkbox" name="genre" value="storytelling"> סיפור סיפורים</label>
                    <label class="option"><input type="checkbox" name="genre" value="luck"> מזל / הימורים</label>
                    <label class="option"><input type="checkbox" name="genre" value="other"> אחר: <input type="text" name="genre_other" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                </div>
            </div>
            
            <button type="button" class="next-section-btn" onclick="goToNextSection(2)">מעבר לשלב הבא ⬅️</button>
            </div>
            
            <div class="section-divider"></div>
            
            <!-- Section 3: Design & Theme -->
            <h2>🎨 שלב 3: עיצוב ותמה</h2>
            <div class="section-content">
            <h3>נושאי רקע וסגנון ויזואלי</h3>
            
            <div class="question">
                <div class="question-title">איזה נושא כללי או תמה מועדפת עליכם? (ניתן לבחור מספר אפשרויות)</div>
                <div class="options">
                    <label class="option"><input type="checkbox" name="theme" value="fantasy"> פנטזיה</label>
                    <label class="option"><input type="checkbox" name="theme" value="scifi"> מדע בדיוני</label>
                    <label class="option"><input type="checkbox" name="theme" value="history"> היסטוריה: <input type="text" name="history_period" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;" placeholder="ציינו תקופה..."></label>
                    <label class="option"><input type="checkbox" name="theme" value="mythology"> מיתולוגיה</label>
                    <label class="option"><input type="checkbox" name="theme" value="horror"> אימה / מתח</label>
                    <label class="option"><input type="checkbox" name="theme" value="comedy"> קומדיה / הומור</label>
                    <label class="option"><input type="checkbox" name="theme" value="realistic"> חיי יום-יום</label>
                    <label class="option"><input type="checkbox" name="theme" value="postapocalyptic"> פוסט-אפוקליפטי</label>
                    <label class="option"><input type="checkbox" name="theme" value="nature"> טבע ובעלי חיים</label>
                    <label class="option"><input type="checkbox" name="theme" value="art"> אומנות / יצירה</label>
                    <label class="option"><input type="checkbox" name="theme" value="sports"> ספורט</label>
                    <label class="option"><input type="checkbox" name="theme" value="culinary"> קולינריה / אוכל</label>
                    <label class="option"><input type="checkbox" name="theme" value="detective"> בלשות / ריגול</label>
                    <label class="option"><input type="checkbox" name="theme" value="western"> מערב פרוע</label>
                    <label class="option"><input type="checkbox" name="theme" value="pirates"> פיראטים</label>
                    <label class="option"><input type="checkbox" name="theme" value="zombies"> זומבים</label>
                    <label class="option"><input type="checkbox" name="theme" value="superheroes"> גיבורי על</label>
                    <label class="option"><input type="checkbox" name="theme" value="surprise"> הפתיעו אותנו!</label>
                    <label class="option"><input type="checkbox" name="theme" value="unique"> נושא ייחודי: <input type="text" name="unique_theme" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                </div>
            </div>
            
            <div class="question">
                <div class="question-title">איזה סגנון ויזואלי מועדף עליכם למשחק?</div>
                <div class="options">
                    <label class="option"><input type="radio" name="visual_style" value="modern"> מודרני / נקי</label>
                    <label class="option"><input type="radio" name="visual_style" value="retro"> רטרו / וינטג'</label>
                    <label class="option"><input type="radio" name="visual_style" value="gothic"> גותי / אפל</label>
                    <label class="option"><input type="radio" name="visual_style" value="cartoon"> קריקטורי / קומיקס</label>
                    <label class="option"><input type="radio" name="visual_style" value="realistic"> ריאליסטי</label>
                    <label class="option"><input type="radio" name="visual_style" value="artnouveau"> ארט-נובו</label>
                    <label class="option"><input type="radio" name="visual_style" value="abstract"> אבסטרקטי / גאומטרי</label>
                    <label class="option"><input type="radio" name="visual_style" value="childlike"> ילדותי</label>
                    <label class="option"><input type="radio" name="visual_style" value="no_preference"> הפתיעו אותנו!</label>
                    <label class="option"><input type="radio" name="visual_style" value="other"> אחר: <input type="text" name="visual_style_other" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                </div>
            </div>
            
            <div class="question">
                <div class="question-title">האם יש פלטת צבעים מועדפת? (אופציונלי)</div>
                <div class="description">בחרו עד 3 צבעים שתרצו לראות במשחק</div>
                <div style="margin-top: 15px;">
                    <label>צבע 1: <input type="color" name="color1" class="color-picker" value="#FFDA1A"></label>
                    <label>צבע 2: <input type="color" name="color2" class="color-picker" value="#4A2C6B"></label>
                    <label>צבע 3: <input type="color" name="color3" class="color-picker" value="#B8A5D1"></label>
                </div>
            </div>
            
            <button type="button" class="next-section-btn" onclick="goToNextSection(3)">מעבר לשלב הבא ⬅️</button>
            </div>
            
            <div class="section-divider"></div>
            
            <!-- Section 4: Personalization -->
            <h2>💫 שלב 4: שילוב פרטים אישיים וסיפורים</h2>
            <div class="section-content">
            <h3>אלמנטים אישיים</h3>
            <div class="description">נשמח לשלב אלמנטים אישיים במשחק! (אין חובה למלא הכל, רק מה שמרגיש לכם רלוונטי וכיפי)</div>
            
            <div class="question">
                <div class="question-title">דמויות מהחיים</div>
                <div id="characters-container"></div>
                <button type="button" class="add-item-btn" onclick="addListItem('characters')">✚ הוספת דמות</button>
            </div>
            
            <div class="question">
                <div class="question-title">מקומות בעלי משמעות</div>
                <div id="places-container"></div>
                <button type="button" class="add-item-btn" onclick="addListItem('places')">✚ הוספת מקום</button>
            </div>
            
            <div class="question">
                <div class="question-title">חפצים אישיים/סמליים</div>
                <div id="items-container"></div>
                <button type="button" class="add-item-btn" onclick="addListItem('items')">✚ הוספת חפץ</button>
            </div>
            
            <div class="question">
                <div class="question-title">ביטויים, כינויים או בדיחות פנימיות</div>
                <div id="phrases-container"></div>
                <button type="button" class="add-item-btn" onclick="addListItem('phrases')">✚ הוספת ביטוי</button>
            </div>
            
            <div class="question">
                <div class="question-title">אירועים מרכזיים או אנקדוטות מהחיים</div>
                <div id="events-container"></div>
                <button type="button" class="add-item-btn" onclick="addListItem('events')">✚ הוספת אירוע</button>
            </div>
            
            <div class="question">
                <div class="question-title">מסורות, תחביבים או פעילויות משותפות</div>
                <div class="options">
                    <label class="option"><input type="checkbox" name="activities" value="trips"> טיולים</label>
                    <label class="option"><input type="checkbox" name="activities" value="cooking"> בישול</label>
                    <label class="option"><input type="checkbox" name="activities" value="movies"> סרטים/סדרות: <input type="text" name="movies_details" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                    <label class="option"><input type="checkbox" name="activities" value="sports"> ספורט: <input type="text" name="sports_details" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                    <label class="option"><input type="checkbox" name="activities" value="art"> אומנות/יצירה</label>
                    <label class="option"><input type="checkbox" name="activities" value="music"> מוזיקה: <input type="text" name="music_details" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                    <label class="option"><input type="checkbox" name="activities" value="other"> אחר: <input type="text" name="activities_other" class="text-input" style="width: 200px; display: inline-block; margin-right: 10px;"></label>
                </div>
            </div>
            
            <button type="button" class="next-section-btn" onclick="goToNextSection(4)">מעבר לשלב הבא ⬅️</button>
            </div>

            <div class="section-divider"></div>

            <!-- Section 5: Additional Details -->
            <h2>📝 שלב 5: פרטים נוספים ודגשים</h2>
            <div class="section-content">
            <h3>מידע משלים ונרטיב</h3>

            <div class="question">
                <div class="question-title">האם יש משחקי קופסה שאתם אוהבים במיוחד? ולמה?</div>
                <div class="description">זה עוזר לנו להבין את הטעם שלכם.</div>
                <textarea class="text-input textarea" name="favorite_games" placeholder="לדוגמה: 'קטאן' בגלל המסחר, 'דיקסיט' בגלל היצירתיות..."></textarea>
            </div>

            <div class="question">
                <div class="question-title">האם יש סיפור מסגרת קיים שתרצו לשלב או לקבל ממנו השראה?</div>
                <div class="description">לדוגמה: ספר אהוב, סרט, אגדה, היסטוריה משפחתית.</div>
                <div class="options">
                    <label class="option"><input type="radio" name="use_narrative" value="no" checked onchange="toggleNarrativeField(false)"> לא</label>
                    <label class="option"><input type="radio" name="use_narrative" value="yes" onchange="toggleNarrativeField(true)"> כן</label>
                </div>
                <div id="narrative-field" class="conditional-field">
                    <input type="text" name="narrative_description" class="text-input" placeholder="פרטו את סיפור המסגרת...">
                </div>
            </div>

            <div class="question">
                <div class="question-title">איזו דינמיקה במשחק חשובה לכם?</div>
                <div class="description">בחרו את האלמנטים שתרצו לראות במשחק</div>
                <div class="options">
                    <label class="option"><input type="checkbox" name="dynamics" value="collaboration"> שיתוף פעולה הדוק</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="competition"> תחרותיות בריאה</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="humor"> הומור הדדי</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="support"> תמיכה</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="challenge"> אתגרים משותפים</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="surprise"> הפתעות ותפניות</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="tension"> מתח ומרגש</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="interaction"> אינטראקציה ישירה בין שחקנים</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="bluffing"> בלוף והטעיה</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="discussion"> דיון וויכוח</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="progression"> התקדמות ופיתוח</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="creativity"> יצירתיות וחשיבה מחוץ לקופסה</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="trading"> מסחר ומיקוח</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="alliance"> יצירת בריתות</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="betrayal"> בגידה (בצורה משחקית)</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="team_play"> משחק קבוצתי</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="voting"> הצבעה קבוצתית</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="simultaneous"> פעולות בו-זמניות</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="risk_taking"> לקיחת סיכונים מחושבים</label>
                    <label class="option"><input type="checkbox" name="dynamics" value="deduction"> דדוקציה והיגיון</label>
                </div>
            </div>

            <div class="question">
                <div class="question-title">האם יש מסר מרכזי או תחושה שהייתם רוצים שהמשחק יעביר?</div>
                <div class="description">לדוגמה: "חשיבותה של חברות", "כמה כיף להיזכר בעבר", "שאנחנו צוות מנצח", "החיים מלאי הפתעות".</div>
                <input type="text" name="central_message" class="text-input" placeholder="המסר או התחושה שלכם...">
            </div>

            <div class="question">
                <div class="question-title">האם יש משהו שהיית רוצה להימנע ממנו במשחק?</div>
                <div class="description">לדוגמה: מכניקות מסוימות, נושאים רגישים, רמת אלימות.</div>
                <textarea class="text-input textarea" name="avoidances" placeholder="דברים שפחות תרצו לראות במשחק..."></textarea>
            </div>

            <div class="question">
                <div class="question-title">כל דבר נוסף שתרצו לספר לנו או להדגיש:</div>
                <textarea class="text-input large-textarea" name="final_notes" placeholder="כאן המקום לכתוב כל מה שעולה על דעתכם..."></textarea>
            </div>
            </div>
            
            <!-- Generate JSON Button -->
            <div style="text-align: center; margin-top: 40px;">
                <button type="button" class="btn json-btn-large" onclick="generateJSON()">✨ צור JSON למשחק שלי ✨</button>
            </div>
        </form>

        <!-- Container for the JSON output -->
        <div id="json-output-container" class="json-output-container">
            <h2>ה-JSON שנוצר:</h2>
            <pre id="json-output" class="json-output"></pre>
            <button id="copy-json-btn" class="copy-btn">העתק JSON</button>
            <span id="copy-feedback" class="copy-feedback">הועתק!</span>
        </div>
    </div>

    <script>
        // --- DYNAMIC LIST MANAGEMENT ---

        const itemTemplates = {
            characters: (index) => `
                <strong style="font-family: 'Fredoka', sans-serif;">דמות ${index}:</strong><br>
                שם: <input type="text" name="character_name_${index}" class="text-input" style="width: 48%; display: inline-block; font-family: 'Fredoka', sans-serif;"><br>
                תיאור: <input type="text" name="character_desc_${index}" class="text-input" placeholder="תפקיד/מאפיין בולט..." style="font-family: 'Fredoka', sans-serif;">
            `,
            places: (index) => `
                <strong style="font-family: 'Fredoka', sans-serif;">מקום ${index}:</strong><br>
                שם: <input type="text" name="place_name_${index}" class="text-input" style="width: 48%; display: inline-block; font-family: 'Fredoka', sans-serif;"><br>
                משמעות: <input type="text" name="place_meaning_${index}" class="text-input" placeholder="למה המקום הזה משמעותי..." style="font-family: 'Fredoka', sans-serif;">
            `,
            items: (index) => `
                <strong style="font-family: 'Fredoka', sans-serif;">חפץ ${index}:</strong><br>
                שם: <input type="text" name="item_name_${index}" class="text-input" style="width: 48%; display: inline-block; font-family: 'Fredoka', sans-serif;"><br>
                סיפור/משמעות: <input type="text" name="item_story_${index}" class="text-input" placeholder="מה הסיפור של החפץ הזה..." style="font-family: 'Fredoka', sans-serif;">
            `,
            phrases: (index) => `
                <strong style="font-family: 'Fredoka', sans-serif;">ביטוי/כינוי ${index}:</strong><br>
                <input type="text" name="phrase_${index}" class="text-input" placeholder="הביטוי או הכינוי..." style="font-family: 'Fredoka', sans-serif;">
            `,
            events: (index) => `
                <strong style="font-family: 'Fredoka', sans-serif;">אירוע ${index}:</strong><br>
                <textarea name="event_${index}" class="text-input textarea" placeholder="תיאור קצר של האירוע..." style="font-family: 'Fredoka', sans-serif;"></textarea>
            `
        };

        function addListItem(type) {
            const container = document.getElementById(`${type}-container`);
            if (!container) return;
            const itemCount = container.children.length + 1;
            const newItem = document.createElement('div');
            newItem.className = 'list-item';
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'remove-item-btn';
            removeBtn.innerHTML = '×';
            removeBtn.onclick = () => newItem.remove();
            newItem.innerHTML = itemTemplates[type](itemCount);
            newItem.prepend(removeBtn);
            container.appendChild(newItem);
        }

        // --- UI LOGIC ---

        function toggleNarrativeField(show) {
            const field = document.getElementById('narrative-field');
            if (field) {
                field.style.display = show ? 'block' : 'none';
            }
        }

        // Navigate to next section
        function goToNextSection(currentSection) {
            const headers = document.querySelectorAll('h2');
            const currentHeader = headers[currentSection - 1];
            const nextHeader = headers[currentSection];
            
            // Close current section
            if (currentHeader) {
                currentHeader.classList.add('collapsed');
                const currentContent = currentHeader.nextElementSibling;
                if (currentContent && currentContent.classList.contains('section-content')) {
                    currentContent.classList.add('collapsed');
                }
            }
            
            // Open next section
            if (nextHeader) {
                nextHeader.classList.remove('collapsed');
                const nextContent = nextHeader.nextElementSibling;
                if (nextContent && nextContent.classList.contains('section-content')) {
                    nextContent.classList.remove('collapsed');
                }
                
                // Scroll to next section with offset
                setTimeout(() => {
                    const headerPosition = nextHeader.getBoundingClientRect().top + window.pageYOffset;
                    window.scrollTo({
                        top: headerPosition - 20,
                        behavior: 'smooth'
                    });
                }, 100);
            }
        }

        // --- JSON GENERATION LOGIC ---

        function generateJSON() {
            const form = document.getElementById('gameForm');
            const formData = new FormData(form);
            const result = {
                basicInfo: {},
                mechanics: {},
                design: {},
                personalization: {
                    characters: [],
                    places: [],
                    items: [],
                    phrases: [],
                    events: [],
                    activities: {}
                },
                additionalInfo: {}
            };

            const processList = (listType, count, fields) => {
                const list = [];
                for (let i = 1; i <= count; i++) {
                    const item = {};
                    let hasData = false;
                    fields.forEach(field => {
                        const key = `${listType}_${field}_${i}`;
                        const value = formData.get(key);
                        if (value) {
                            item[field] = value;
                            hasData = true;
                        }
                    });
                    if (hasData) {
                        list.push(item);
                    }
                }
                return list;
            };
            
            const processSingleList = (listType, count) => {
                const list = [];
                 for (let i = 1; i <= count; i++) {
                    const key = `${listType}_${i}`;
                    const value = formData.get(key);
                    if (value) list.push(value);
                 }
                 return list;
            }

            // Section 1: Basic Info
            result.basicInfo.target = formData.get('target');
            result.basicInfo.targetDescription = formData.get('target_description');
            result.basicInfo.players = formData.get('players') === 'other' ? formData.get('players_other') : formData.get('players');
            result.basicInfo.duration = formData.get('duration');
            result.basicInfo.eventPurpose = formData.get('event_purpose');

            // Section 2: Mechanics
            result.mechanics.complexity = formData.get('complexity');
            result.mechanics.genres = formData.getAll('genre');
            if (formData.get('genre_other')) {
                result.mechanics.genres.push(`Other: ${formData.get('genre_other')}`);
            }

            // Section 3: Design
            result.design.themes = formData.getAll('theme');
            if (formData.get('history_period')) {
                 result.design.themes.push(`History: ${formData.get('history_period')}`);
            }
            if (formData.get('unique_theme')) {
                 result.design.themes.push(`Unique: ${formData.get('unique_theme')}`);
            }
            result.design.visualStyle = formData.get('visual_style') === 'other' ? formData.get('visual_style_other') : formData.get('visual_style');
            result.design.colorPalette = [formData.get('color1'), formData.get('color2'), formData.get('color3')];

            // Section 4: Personalization
            result.personalization.characters = processList('character', document.getElementById('characters-container').children.length, ['name', 'desc']);
            result.personalization.places = processList('place', document.getElementById('places-container').children.length, ['name', 'meaning']);
            result.personalization.items = processList('item', document.getElementById('items-container').children.length, ['name', 'story']);
            result.personalization.phrases = processSingleList('phrase', document.getElementById('phrases-container').children.length);
            result.personalization.events = processSingleList('event', document.getElementById('events-container').children.length);
            const activities = formData.getAll('activities');
            activities.forEach(activity => {
                const detailKey = `${activity}_details`;
                result.personalization.activities[activity] = formData.get(detailKey) || true;
            });
             if (formData.get('activities_other')) {
                result.personalization.activities.other = formData.get('activities_other');
            }
            
            // Section 5: Additional Info
            result.additionalInfo.favoriteGames = formData.get('favorite_games');
            const useNarrative = formData.get('use_narrative') === 'yes';
            result.additionalInfo.narrativeFramework = {
                useExisting: useNarrative,
                description: useNarrative ? formData.get('narrative_description') : null
            };
            result.additionalInfo.dynamics = formData.getAll('dynamics');
            result.additionalInfo.centralMessage = formData.get('central_message');
            result.additionalInfo.avoidances = formData.get('avoidances');
            result.additionalInfo.finalNotes = formData.get('final_notes');

            const outputContainer = document.getElementById('json-output-container');
            const outputElement = document.getElementById('json-output');
            outputElement.textContent = JSON.stringify(result, null, 2);
            outputContainer.style.display = 'block';
            outputContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // --- COPY TO CLIPBOARD ---
        document.getElementById('copy-json-btn').addEventListener('click', () => {
            const jsonText = document.getElementById('json-output').textContent;
            if (navigator.clipboard && window.isSecureContext) {
                 navigator.clipboard.writeText(jsonText).then(() => showCopyFeedback());
            } else {
                const textArea = document.createElement('textarea');
                textArea.value = jsonText;
                textArea.style.position = 'fixed';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showCopyFeedback();
                } catch (err) {
                    console.error('Fallback: Oops, unable to copy', err);
                }
                document.body.removeChild(textArea);
            }
        });

        function showCopyFeedback() {
            const feedback = document.getElementById('copy-feedback');
            feedback.style.opacity = '1';
            setTimeout(() => {
                feedback.style.opacity = '0';
            }, 2000);
        }

        // Initialize the form
        window.onload = () => {
            addListItem('characters');
            addListItem('places');
            addListItem('items');
            addListItem('phrases');
            addListItem('events');
            toggleNarrativeField(false);
            
            // Add collapse/expand functionality to all h2 elements
            const sectionHeaders = document.querySelectorAll('h2');
            sectionHeaders.forEach((header, index) => {
                // Start all sections collapsed
                header.classList.add('collapsed');
                const content = header.nextElementSibling;
                if (content && content.classList.contains('section-content')) {
                    content.classList.add('collapsed');
                }
                
                // Add click handler
                header.addEventListener('click', function() {
                    this.classList.toggle('collapsed');
                    const content = this.nextElementSibling;
                    if (content && content.classList.contains('section-content')) {
                        content.classList.toggle('collapsed');
                    }
                });
            });
        };
    </script>
</body>
</html>
